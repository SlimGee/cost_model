<%# app/views/calculations/_line_item_fields.html.erb %>
<div
  class="
    grid grid-cols-12 gap-2 p-3 bg-gray-50 rounded border border-gray-200
    nested-fields
  "
>
  <%= f.hidden_field :category %>
  <%= f.hidden_field :position %>
  <%= f.hidden_field :is_per_build,
                 value: f.object.is_per_build.nil? ? true : f.object.is_per_build %>

  <div class="col-span-3">
    <%= f.text_field :name,
                 placeholder: "Item name",
                 class:
                   "w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500" %>
  </div>

  <div class="col-span-3">
    <%= f.text_field :description,
                 placeholder: "Description",
                 class:
                   "w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500" %>
  </div>

  <div class="col-span-2">
    <%= f.number_field :unit_cost,
                   step: "0.01",
                   placeholder: "Unit cost",
                   class:
                     "w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500" %>
  </div>

  <div class="col-span-1">
    <%= f.number_field :quantity,
                   step: "0.01",
                   placeholder: "Qty",
                   class:
                     "w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500" %>
  </div>

  <div class="col-span-2">
    <%= f.select :unit_type,
             options_for_select(
               [
                 %w[Hours hours],
                 %w[kg kg],
                 %w[kWh kWh],
                 %w[m³ m³],
                 ["Per Build", "per_build"],
                 ["Per Part", "per_part"],
                 %w[Units units],
               ],
               f.object.unit_type,
             ),
             {},
             class:
               "w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500" %>
  </div>

  <div class="col-span-1 flex items-center justify-center">
    <% if f.object.persisted? %>
      <%= f.check_box :_destroy, class: "hidden destroy-checkbox" %>
      <button
        type="button"
        onclick="removeLineItemField(this)"
        class="text-red-600 hover:text-red-800 text-sm font-bold"
        title="Remove item"
      >
        ✕
      </button>
    <% else %>
      <button
        type="button"
        onclick="this.closest('.nested-fields').remove()"
        class="text-red-600 hover:text-red-800 text-sm font-bold"
        title="Remove item"
      >
        ✕
      </button>
    <% end %>
  </div>
</div>
